1. At your home directory on the hopper, create conda environment.
$ conda init bash
$ conda create -n bcb5250 python=3.7
$ conda create -n bcb5250

2. Activate the environment
$ conda activate bcb5250

3. Install Bowtie2
$ conda install bowtie2

4. Intall Metaphlan2
$ conda install -c bioconda metaphlan2
$ conda install -c bioconda metaphlan2=2.7.7

5. Install Human2
$ conda install -c biobakery humann2
==> This is not working well with the python 3.7 env


ERROR: The MetaPhlAn2 taxonomic profile was generated with the CHOCOPhlAn_201901 database. HUMANn2 is not yet compatible with this database. Please run with the legacy MetaPhlAn2 database. Also keep an eye out for HUMAnN2 v2.9 which will be compatible with the latest MetaPhlAn2 v2.9 database.

https://forum.biobakery.org/t/how-to-install-metaphlan2-legacy-database/171/4


Don't do it!
==> WARNING: A newer version of conda exists. <==
  current version: 4.8.1
  latest version: 4.8.3

Please update conda by running

    $ conda update -n base -c defaults conda

The following NEW packages will be INSTALLED:
YES




[cgardne7@biohpc01 ~]$ python --version
Python 2.7.5


$ 
$ conda create -n bcb5250_python275 
$ conda activate bcb5250_python275
$ conda install -c bioconda bowtie2=2.3.5.1=py27he513fc3_0
$ conda install -c bioconda metaphlan2=2.7.7
$ pip install humann2
$ humann2_databases --download chocophlan DEMO humann2_database_downloads
$ humann2_databases --download uniref DEMO_diamond humann2_database_downloads

(bcb5250_python275) [ahnt@hopper:~/Course/bcb5250/2020S/labs/metagenomics_wgs_lab/mgs_tutorial_Oct2017/raw_data_example]$ humann2 --input demo.fastq --output demo_fastq
Creating output directory: /faculty/ahnt/Course/bcb5250/2020S/labs/metagenomics_wgs_lab/mgs_tutorial_Oct2017/raw_data_example/demo_fastq
Output files will be written to: /faculty/ahnt/Course/bcb5250/2020S/labs/metagenomics_wgs_lab/mgs_tutorial_Oct2017/raw_data_example/demo_fastq

Running metaphlan2.py ........

Found g__Bacteroides.s__Bacteroides_dorei : 59.40% of mapped reads
Found g__Bacteroides.s__Bacteroides_vulgatus : 40.60% of mapped reads

Total species selected from prescreen: 2

Selected species explain 100.00% of predicted community composition


Creating custom ChocoPhlAn database ........


Running bowtie2-build ........


Running bowtie2 ........

Total bugs from nucleotide alignment: 2
g__Bacteroides.s__Bacteroides_vulgatus: 7336 hits
g__Bacteroides.s__Bacteroides_dorei: 8820 hits

Total gene families from nucleotide alignment: 3685

Unaligned reads after nucleotide alignment: 23.0666666667 %


Running diamond ........


Aligning to reference database: uniref90_demo_prots.dmnd

Total bugs after translated alignment: 3
g__Bacteroides.s__Bacteroides_vulgatus: 7336 hits
unclassified: 974 hits
g__Bacteroides.s__Bacteroides_dorei: 8820 hits

Total gene families after translated alignment: 3728

Unaligned reads after translated alignment: 18.5571428571 %


Computing gene families ...

Computing pathways abundance and coverage ...

Output files created:
/faculty/ahnt/Course/bcb5250/2020S/labs/metagenomics_wgs_lab/mgs_tutorial_Oct2017/raw_data_example/demo_fastq/demo_genefamilies.tsv
/faculty/ahnt/Course/bcb5250/2020S/labs/metagenomics_wgs_lab/mgs_tutorial_Oct2017/raw_data_example/demo_fastq/demo_pathabundance.tsv
/faculty/ahnt/Course/bcb5250/2020S/labs/metagenomics_wgs_lab/mgs_tutorial_Oct2017/raw_data_example/demo_fastq/demo_pathcoverage.tsv




https://groups.google.com/forum/#!topic/humann-users/MSVmXC7DSW0



$ conda install -c conda-forge glpk
